<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Barcode Scanner</title>

  <!-- âœ… FIXED CSS PATH -->
  <link rel="stylesheet" href="./style.css" />

  <!-- âœ… SIMPLE AUTH GUARD -->
  <script>
    // If user is not logged in, go back to signin page
    if (!localStorage.getItem("user")) {
      window.location.href = "../login-UI/signin.html";
    }
  </script>
</head>
<body>

<!-- ================= HEADER ================= -->
<header class="header">
  <div class="header-left">
    <div class="logo">â¬š</div>
    <span class="title" id="dashboard-title">Dashboard</span>
  </div>

  <div class="header-right">
    <button class="logout-btn" onclick="logout()">Logout</button>
  </div>
</header>

<!-- ================= MAIN ================= -->
<main class="container">

  <!-- ================= SCAN ================= -->
  <div class="card scan-card">
    <h3>Scan Barcode</h3>

    <button id="scanBtn" class="scan-btn" onclick="openScanner()">
        ðŸ“· Open Camera Scanner
    </button>

    <div class="divider">OR ENTER MANUALLY</div>

    <div class="manual-row">
      <input id="barcode-input" placeholder="Enter barcode..." />
      <button class="save-btn" onclick="saveBarcode()">Save</button>
    </div>
  </div>

  <!-- ================= TABS ================= -->
  <div class="tabs">
    <button class="tab active" onclick="showTab('my', this)">My Barcodes</button>
    <button class="tab" onclick="showTab('common', this)">Common Summary</button>
  </div>

  <!-- ================= MY BARCODES ================= -->
  <div id="my" class="card tab-content">

    <div class="card-header">
      <h3>My Barcodes</h3>
      <button class="excel-btn" onclick="downloadMyBarcodesExcel()">
        ðŸ“Š Download Excel
      </button>

    </div>

    <table>
      <thead>
        <tr>
          <th>
            <input type="checkbox" id="selectAll" onclick="toggleSelectAll(this)">
            Barcode
          </th>
          <th>Count</th>
          <th>Last Scanned</th>
          <th>
            <button class="delete-btn" onclick="deleteSelected()">
              ðŸ—‘ Delete Selected
            </button>
          </th>
        </tr>
      </thead>
      <tbody id="myBarcodesBody"></tbody>
    </table>

  </div>

  <!-- ================= COMMON SUMMARY ================= -->
  <div id="common" class="card tab-content hidden">

    <div class="card-header">
      <h3>Common Summary</h3>
      <button class="excel-btn" onclick="downloadCommonSummaryExcel()">
        ðŸ“Š Download Excel
      </button>
    </div>

    <table>
      <thead>
        <tr>
          <th>
            <input type="checkbox"
              onclick="document
                .querySelectorAll('.common-check')
                .forEach(cb => cb.checked = this.checked)">
            Barcode
          </th>
          <th>User Counts</th>
          <th>Total</th>
          <th>
            <button class="delete-btn" onclick="deleteCommonSelected()">
              ðŸ—‘ Delete Selected
            </button>
          </th>
        </tr>
      </thead>
      <tbody id="commonSummaryBody"></tbody>
    </table>

  </div>

</main>

<!-- ================= SCANNER OVERLAY ================= -->
<div id="scannerOverlay" class="scanner-overlay hidden">
  <button class="scanner-close" onclick="closeScanner()">âœ•</button>

  <div class="scanner-box">
    <div class="scanner-frame">
      <div id="reader"></div>
    </div>

    <h3 class="scanner-title">Point camera at barcode</h3>
    <p class="scanner-hint">
      Hold steady and center the barcode in the box
    </p>

    </div>
</div>

  <!-- âœ… SCAN CONFIRMATION -->
<div id="scanSuccess" class="scan-success hidden">âœ… Saved</div>


<!-- ================= CUSTOM NOTIFICATION ================= -->
<div id="notifyOverlay" class="notify-overlay hidden">
  <div class="notify-box">
    <p id="notifyMessage"></p>
    <button class="notify-btn" onclick="closeNotify()">OK</button>
  </div>
</div>

<!-- ================= SCRIPTS ================= -->
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script src="https://unpkg.com/html5-qrcode"></script>


<!-- âœ… FIXED SCRIPT PATH -->
<script src="./script.js"></script>

</body>
</html>







